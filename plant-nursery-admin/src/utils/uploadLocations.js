// src/utils/uploadLocations.js
import { db } from '../firebase/firebase';
import { doc, setDoc } from 'firebase/firestore';

// Paste your RAW CSV lines here (from your file, without the header)
const csvLines = `
"مكة المكرمة , القنفذة , حي الأزهار"
"مكة المكرمة , القنفذة , حي الخالدية"
"مكة المكرمة , القنفذة , حي الرتبة"
"مكة المكرمة , القنفذة , حي الشرقية"
"مكة المكرمة , القنفذة , حي الكورنيش الغربى"
"مكة المكرمة , الليث , حي الشاطئ"
"مكة المكرمة , الليث , حي الليث"
"مكة المكرمة , الليث , حي الملك عبدالعزيز"
"مكة المكرمة , الليث , حي الملك فيصل"
"مكة المكرمة , الليث , حي عكرمة بن أبي جهل"
"مكة المكرمة , الليث , حي عمرو بن العاص"
"مكة المكرمة , جدة , حي السنابل"
"مكة المكرمة , جدة , حي الأجاويد"
"مكة المكرمة , جدة , حي الهدي"
"مكة المكرمة , جدة , حي الأمير عبد المجيد"
"مكة المكرمة , جدة , حي العدل"
"مكة المكرمة , جدة , حي الأمير فواز"
"مكة المكرمة , جدة , حي الجوهرة"
"مكة المكرمة , جدة , حي الشفا"
"مكة المكرمة , جدة , حي الرياض"
"مكة المكرمة , جدة , حي طيبة"
"مكة المكرمة , جدة , حي أبحر"
"مكة المكرمة , جدة , حي الشراع"
"مكة المكرمة , جدة , حي الياقوت"
"مكة المكرمة , جدة , حي الأمواج"
"مكة المكرمة , جدة , حي الحمدانية"
"مكة المكرمة , جدة , حي البشائر"
"مكة المكرمة , جدة , حي الرحمانية"
"مكة المكرمة , جدة , حي الكوثر"
"مكة المكرمة , جدة , حي الريان"
"مكة المكرمة , جدة , حي الصالحية"
"مكة المكرمة , جدة , حي الوفاء"
"مكة المكرمة , جدة , حي الفلاح"
"مكة المكرمة , جدة , حي الفروسية"
"مكة المكرمة , جدة , حي العزيزية"
"مكة المكرمة , جدة , حي السامر"
"مكة المكرمة , جدة , حي المنار"
"مكة المكرمة , جدة , حي الواحة"
"مكة المكرمة , جدة , حي الأجواد"
"مكة المكرمة , جدة , حي النعيم"
"مكة المكرمة , جدة , حي المحمدية"
"مكة المكرمة , جدة , حي المرجان"
"مكة المكرمة , جدة , حي البساتين"
"مكة المكرمة , جدة , حي النسيم"
"مكة المكرمة , جدة , حي السليمانية"
"مكة المكرمة , جدة , حي الفيصلية"
"مكة المكرمة , جدة , حي الفضيلة"
"مكة المكرمة , جدة , حي القرينية"
"مكة المكرمة , جدة , حي الخمرة"
"مكة المكرمة , مكة المكرمة , حي التنعيم"
"مكة المكرمة , مكة المكرمة , حي الزايدي"
"مكة المكرمة , مكة المكرمة , حي الصفا"
"المدينة المنورة , المدينة المنورة , حي الجماوات"
"المدينة المنورة , المدينة المنورة , حي الخالدية"
"المدينة المنورة , المدينة المنورة , حي الدفاع"
"المدينة المنورة , المدينة المنورة , حي السلام"
"المدينة المنورة , المدينة المنورة , حي العزيزية"
"المدينة المنورة , المدينة المنورة , حي الملك عبدالعزيز"
"المدينة المنورة , محافظة الحناكية , حي الأمير ماجد"
"المدينة المنورة , محافظة الحناكية , حي الحناكية"
"الباحة , الباحة , حي الأزهر"
"الباحة , الباحة , حي الباهر"
"الباحة , الباحة , حي الحاوية"
"الباحة , الباحة , حي الزرقاء"
"الباحة , الباحة , حي السلامة"
"الباحة , الباحة , حي الشروق"
"الباحة , الباحة , حي الشفا"
"الباحة , الباحة , حي الشهبة"
"الباحة , الباحة , حي الصفا"
"الباحة , الباحة , حي الظفير"
"الباحة , الباحة , حي النزهة"
"الباحة , الباحة , حي رغدان"
"الباحة , الباحة , حي وسط المدينة"
"الباحة , المندق , حي البدر"
"الباحة , المندق , حي العزيزية"
"الباحة , المندق , حي النصباء"
"الباحة , بلجرشي , حي البركة"
"الباحة , بلجرشي , حي المحمدية"
"الباحة , بلجرشي , حي النقاء"
"الباحة , بلجرشي , حي بادية بني كبير"
"الباحة , بلجرشي , حي بكير"
"الباحة , بلجرشي , حي بني عامر"
"الباحة , بلجرشي , حي وسط"
"الرياض , الرياض , حي الغدير"
"الرياض , الرياض , حي الفلاح"
"الرياض , الرياض , حي النفل"
"الرياض , الرياض , حي الوادي"
"الرياض , الزلفي , حي الخالدية"
"الرياض , الزلفي , حي السلام"
"الرياض , الزلفي , حي السيح"
"الرياض , الزلفي , حي الصناعية"
"الرياض , الزلفي , حي العزيزية"
"الرياض , الزلفي , حي الفاروق"
"الرياض , الزلفي , حي القدس"
"الرياض , الزلفي , حي اليرموك"
"الرياض , الزلفي , حي سمنان"
"الرياض , الغاط , حي الخزامى"
"الرياض , الغاط , حي النخيل"
"الرياض , المجمعة , حي الفيحاء"
"الرياض , المجمعة , حي المرقب"
"الرياض , المجمعة , حي المستقبل"
"الرياض , المجمعة , حي المطار"
"الرياض , المجمعة , حي الملك سلمان"
"الرياض , المجمعة , حي الملك عبدالعزيز"
"الرياض , المجمعة , حي الملك عبدالله"
"الرياض , المجمعة , حي الملك فهد"
"الرياض , المجمعة , حي اليرموك"
"الرياض , تمير , حي الخالدية"
"الرياض , تمير , حي العزيزية"
"الرياض , تمير , حي الملك عبدالله"
"الرياض , تمير , حي المنتزه"
"الرياض , جلاجل , حي الشعبية"
"الرياض , جلاجل , حي الصناعية"
"الرياض , سدير , حي أم عنيق"
"الرياض , سدير , حي الروضة"
"الرياض , سدير , حي الريان"
"الرياض , سدير , حي الزهرة"
"الرياض , سدير , حي الشبيلية"
"الرياض , سدير , حي الشفاء"
"الرياض , سدير , حي الطالعية"
"الرياض , سدير , حي العزيزية"
"الرياض , سدير , حي القادسية"
"الرياض , سدير , حي المعشبة"
"الرياض , سدير , حي الملك سلمان"
"الرياض , سدير , حي النفل"
"الرياض , سدير , حي النهضة"
"الرياض , سدير , حي الوسطى"
"الرياض , سدير , حي بدر"
"الرياض , شقراء , حي الرحبة"
"الرياض , شقراء , حي الروضة"
"الرياض , شقراء , حي الشفاء"
"الرياض , شقراء , حي القارة"
"الرياض , شقراء , حي المعارض"
"الرياض , شقراء , حي الملك فهد"
"القصيم , البدائع , حي الرمة"
"القصيم , البدائع , حي السلام"
"القصيم , البدائع , حي الشيرمي"
"القصيم , البدائع , حي المرقب"
"القصيم , البدائع , حي الوسطي"
"القصيم , البكيرية , حي الزهرة"
"القصيم , البكيرية , حي الفهد"
"القصيم , البكيرية , حي المحمدية"
"القصيم , البكيرية , حي المنتزه"
"القصيم , البكيرية , حي النهضة"
"القصيم , الرس , حي الزهرة"
"القصيم , المذنب , حي البستان"
"القصيم , المذنب , حي الجديدة"
"القصيم , المذنب , حي الحزم"
"القصيم , المذنب , حي الخالدية"
"القصيم , المذنب , حي الصالحية"
"القصيم , المذنب , حي الصفراء"
"القصيم , بريدة , حي البساتين"
"القصيم , بريدة , حي السلام"
"القصيم , رياض الخبراء , حي التعاون"
"القصيم , رياض الخبراء , حي الحزم"
"القصيم , رياض الخبراء , حي النزهة"
"القصيم , رياض الخبراء , حي النهضة"
"القصيم , رياض الخبراء , حي زبيدة"
"القصيم , عقلة الصقور , حي الروضة"
"القصيم , عقلة الصقور , حي السعادة"
"القصيم , عقلة الصقور , حي العزيزية"
"القصيم , عنيزة , حي الضليعة"
"القصيم , عنيزة , حي العليا"
"القصيم , عيون الجواء , حي التعليم"
"القصيم , عيون الجواء , حي الخنزان"
"القصيم , عيون الجواء , حي المرقب"
"القصيم , عيون الجواء , حي المنتزه"
"القصيم , عيون الجواء , حي النزهة"
"القصيم , عيون الجواء , حي النهضة"
"جازان , الأطاولة , حي المجد"
"جازان , بيش , حي الإسكان"
"جازان , بيش , حي الخالدية"
"جازان , بيش , حي السلام"
"جازان , بيش , حي السلامة"
"جازان , بيش , حي الشرقي"
"جازان , بيش , حي الشريعة"
"جازان , بيش , حي النهضة"
"جازان , جيزان , حي الجبل"
"جازان , جيزان , حي الروابي"
"جازان , جيزان , حي الروضة"
"جازان , جيزان , حي الزهور"
"جازان , جيزان , حي السويس"
"جازان , جيزان , حي الشاطئ"
"جازان , جيزان , حي الصفا"
"جازان , جيزان , حي المطار"
"جازان , جيزان , حي النور"
"جازان , صبيا , حي الربيع"
"جازان , صبيا , حي الرحاب"
"جازان , صبيا , حي السعادة"
"جازان , صبيا , حي الظبية"
"جازان , صبيا , حي العزيزية"
"جازان , صبيا , حي الفيصلية"
"جازان , صبيا , حي المجد"
"جازان , صبيا , حي المروج"
"جازان , صبيا , حي الملك فهد"
"جازان , صبيا , حي النهضة"
"حائل , حائل , حي اجا"
"حائل , حائل , حي البحيرة"
"حائل , حائل , حي الخزامي"
"حائل , حائل , حي الرصف"
"حائل , حائل , حي الزبارة"
"حائل , حائل , حي الزهراء"
"حائل , حائل , حي السمراء"
"حائل , حائل , حي الشفاء"
"حائل , حائل , حي العزيزية"
"حائل , حائل , حي المحطة"
"حائل , حائل , حي المصيف"
"حائل , حائل , حي المطار"
"حائل , حائل , حي المنتزه الشرقي"
"حائل , حائل , حي المنتزه الغربي"
"حائل , حائل , حي النقرة"
"حائل , حائل , حي الوادي"
"حائل , حائل , حي الوسيطاء"
"حائل , حائل , حي برزان"
"حائل , حائل , حي حدري البلاد"
"حائل , حائل , حي دمشق"
"حائل , حائل , حي سماح"
"حائل , حائل , حي صبابة"
"حائل , حائل , حي صديان"
"حائل , حائل , حي صلاح الدين الغربي"
"حائل , حائل , حي لبدة"
"عسير , أبها , حي الخالدية"
"عسير , أبها , حي الخشع"
"عسير , أبها , حي الربوة"
"عسير , أبها , حي السد"
"عسير , أبها , حي السروات"
"عسير , أبها , حي الشمسان"
"عسير , أبها , حي الطبجية"
"عسير , أبها , حي العرين"
"عسير , أبها , حي الفيصلية"
"عسير , أبها , حي القابل"
"عسير , أبها , حي القرى"
"عسير , أبها , حي المفتاحة"
"عسير , أبها , حي الموظفين"
"عسير , أبها , حي النزهة"
"عسير , أبها , حي النصب"
"عسير , أبها , حي الوردتين"
"عسير , أبها , حي الوصايف"
"عسير , أبها , حي دلغان"
"عسير , أبها , حي ذرة"
"تبوك , تبوك , حي الريان"
"تبوك , تبوك , حي الراجحي"
"تبوك , تبوك , حي الروضة"
"تبوك , تبوك , حي الصالحية"
"تبوك , تبوك , حي الصفا"
"تبوك , تبوك , حي السليمانية"
"تبوك , تبوك , حي العزيزية القديمة"
"تبوك , تبوك , حي المروج"
"تبوك , تبوك , حي مروج الأمير"
"تبوك , تبوك , حي المهرجان"
"تبوك , تبوك , حي المصيف"
"تبوك , تبوك , حي القادسية"
"تبوك , تبوك , حي النهضة"
"تبوك , تبوك , حي الورود"
"تبوك , تبوك , حي الفيصلية الجنوبية"
"تبوك , تبوك , حي الفيصلية الشمالية"
"تبوك , تبوك , حي بترومين"
"تبوك , العُيَيرة , حي المطار"
"تبوك , العُيَيرة , حي السوق"
"تبوك , تيماء , حي أبيط"
"تبوك , تيماء , حي العسافية"
"تبوك , تيماء , حي الجبعاوية"
"تبوك , تيماء , حي الحزم"
"تبوك , تيماء , حي الهوجاء (الهوج)"
"تبوك , تيماء , حي الكتيب"
"تبوك , تيماء , الحي المركزي"
"تبوك , ضباء , حي الساحل"
"تبوك , ضباء , حي القرفاء"
"تبوك , ضباء , حي المطار"
"تبوك , ضباء , حي المقيطع"
"تبوك , الوجه , البلدة التاريخية"
"تبوك , الوجه , الحي الجديد"
"تبوك , الوجه , حي الفريعه"
"تبوك , الوجه , حي اليرموك"
"تبوك , الوجه , مخطط الورود 110"
"نجران , نجران , أبا الرشاش الأعلى"
"نجران , نجران , أبا الرشاش الأسفل"
"نجران , نجران , الابرقين"
"نجران , نجران , الأخدود"
"نجران , نجران , الجربة"
"نجران , نجران , الحايرة"
"نجران , نجران , الحصين"
"نجران , نجران , الخالدية"
"نجران , نجران , الخضراء القديمة"
"نجران , نجران , الخرعاء"
"نجران , نجران , الفيصلية"
"نجران , نجران , الأمير مشعل"
"نجران , نجران , الجامعة"
"نجران , نجران , الروضة"
"نجران , نجران , الرويكبة"
"نجران , نجران , الصفا"
"نجران , نجران , الشرفة"
"نجران , نجران , الشرفة الشرقية"
"نجران , نجران , الشرفة الغربية"
"نجران , نجران , الشرفة الشمالية"
"نجران , نجران , الشرفة الجنوبية"
"نجران , نجران , الشبهان"
"نجران , نجران , الشعبة الشرقية"
"نجران , نجران , الشعبة الغربية"
"نجران , نجران , الصناعية"
"نجران , نجران , العان"
"نجران , نجران , العريسة"
"نجران , نجران , الغويلا أ"
"نجران , نجران , الغويلا ب"
"نجران , نجران , الغويلا د"
"نجران , نجران , المسماة"
"نجران , نجران , المركب"
"نجران , نجران , النهضة"
"نجران , نجران , نهيقة"
"نجران , نجران , نهوقة"
"نجران , نجران , فواز"
"نجران , نجران , غرب الدارة"
"نجران , خباش , "
"نجران , يدمة , "
"الحدود الشماليه , العويقيلة , ,"
"الحدود الشماليه , طريف , حي العزيزية"
"الحدود الشماليه , طريف , حي العزيزية القديمة"
"الحدود الشماليه , طريف , حي الملك عبد الله"
"الحدود الشماليه , طريف , حي الملك فيصل"
"الحدود الشماليه , طريف , حي الملك فهد"
"الحدود الشماليه , طريف , حي النور"
"الحدود الشماليه , طريف , حي الرضا"
"الحدود الشماليه , طريف , حي الريان"
"الحدود الشماليه , طريف , حي الصالحية"
"الحدود الشماليه , طريف , حي الفيصلية"
"الحدود الشماليه , طريف , حي الجامعة"
"الحدود الشماليه , طريف , حي المطار"
"الحدود الشماليه , طريف , حي السلام"
"الحدود الشماليه , طريف , حي النهضة"
"الحدود الشماليه , رفحاء , حي الأندلس"
"الحدود الشماليه , رفحاء , حي البديع"
"الحدود الشماليه , رفحاء , حي الصناعي"
"الحدود الشماليه , رفحاء , حي الفيصلية"
"الحدود الشماليه , رفحاء , حي الملك عبدالعزيز"
"الحدود الشماليه , رفحاء , حي الملك فهد"
"الحدود الشماليه , رفحاء , حي المطار"
"الحدود الشماليه , رفحاء , حي المنتزه"
"الحدود الشماليه , رفحاء , حي النزهة"
"الحدود الشماليه , رفحاء , حي النرجس"
"الحدود الشماليه , رفحاء , حي السلام"
"الحدود الشماليه , رفحاء , حي الشفا"
"الحدود الشماليه , رفحاء , حي الورود"
"الحدود الشماليه , رفحاء , حي الياسمين"
"الجوف , دومة الجندل , حي الأندلس"
"الجوف , دومة الجندل , حي البديع"
"الجوف , دومة الجندل , حي الحي القديم (المنطقة التاريخية)"
"الجوف , دومة الجندل , حي الفيصلية"
"الجوف , دومة الجندل , حي الملك عبدالعزيز"
"الجوف , دومة الجندل , حي الملك فهد"
"الجوف , دومة الجندل , حي المطار"
"الجوف , دومة الجندل , حي النزهة"
"الجوف , دومة الجندل , حي السلام"
"الجوف , دومة الجندل , حي الصناعي"
"الجوف , دومة الجندل , حي الورود"
"الجوف , دومة الجندل , حي الياسمين"
"الجوف , طبرجل , حي الأندلس"
"الجوف , طبرجل , حي الفيصلية"
"الجوف , طبرجل , حي الملك عبدالعزيز"
"الجوف , طبرجل , حي الملك فهد"
"الجوف , طبرجل , حي المنتزه"
"الجوف , طبرجل , حي النزهة"
"الجوف , طبرجل , حي النرجس"
"الجوف , طبرجل , حي السلام"
"الجوف , طبرجل , حي الصناعي"
"الجوف , طبرجل , حي الشفا"
"الجوف , طبرجل , حي الورود"
"المنطقة الشرقية , الدمام , حي عبدالله فؤاد وما حوله"
"المنطقة الشرقية , الدمام , حي الشاطئ"
"المنطقة الشرقية , الخبر , الخبر الشمالية"
"المنطقة الشرقية , الخبر , حي الثقبة"
"المنطقة الشرقية , الظهران , حي الدوحة"
"المنطقة الشرقية , الظهران , حي الربوة"
"المنطقة الشرقية , الأحساء , وسط الهفوف"
"المنطقة الشرقية , الأحساء , حي الريان"
"المنطقة الشرقية , الأحساء , حي الحزم"
"المنطقة الشرقية , الأحساء , حي محاسن"
"المنطقة الشرقية , بقيق , حي الأندلس"
"المنطقة الشرقية , بقيق , حي أرامكو (مجمع سكني لموظفي أرامكو)"
"المنطقة الشرقية , بقيق , حي الحي القديم"
"المنطقة الشرقية , بقيق , حي الفيصلية"
"المنطقة الشرقية , بقيق , حي الملك عبدالعزيز"
"المنطقة الشرقية , بقيق , حي الملك فهد"
"المنطقة الشرقية , بقيق , حي النزهة"
"المنطقة الشرقية , بقيق , حي السلام"
"المنطقة الشرقية , بقيق , حي الصناعي"
"المنطقة الشرقية , بقيق , حي الشفا"
"المنطقة الشرقية , بقيق , حي الورود"
"المنطقة الشرقية , بقيق , حي الياسمين"
"المنطقة الشرقية , النعيرية , حي الأندلس"
"المنطقة الشرقية , النعيرية , حي البديع"
"المنطقة الشرقية , النعيرية , حي الفيصلية"
"المنطقة الشرقية , النعيرية , حي الملك عبدالعزيز"
"المنطقة الشرقية , النعيرية , حي الملك فهد"
"المنطقة الشرقية , النعيرية , حي المنتزه"
"المنطقة الشرقية , النعيرية , حي النزهة"
"المنطقة الشرقية , النعيرية , حي النرجس"
"المنطقة الشرقية , النعيرية , حي السلام"
"المنطقة الشرقية , النعيرية , حي الصناعي"
"المنطقة الشرقية , النعيرية , حي الشاطئ"
"المنطقة الشرقية , النعيرية , حي الورود"
"المنطقة الشرقية , النعيرية , حي الياسمين"
`.trim().split('\n').filter(line => line.trim() !== '');

export const uploadLocationsToFirestore = async () => {
  const regionsMap = new Map();

  csvLines.forEach(line => {
    // Clean and split
    const clean = line.replace(/"/g, '').trim();
    const parts = clean.split(',').map(p => p.trim());

    if (parts.length < 3) return;

    const [region, city, district] = parts;

    // Skip invalid or empty districts
    if (!region || !city || !district || district === '') return;

    if (!regionsMap.has(region)) {
      regionsMap.set(region, new Map());
    }

    const citiesMap = regionsMap.get(region);
    if (!citiesMap.has(city)) {
      citiesMap.set(city, new Set());
    }
    citiesMap.get(city).add(district);
  });

  // Build final structured array
  const locationsArray = Array.from(regionsMap.entries()).map(([region, citiesMap]) => ({
    region,
    cities: Array.from(citiesMap.entries()).map(([city, districts]) => ({
      name: city,
      districts: Array.from(districts).sort()
    }))
  })).sort((a, b) => a.region.localeCompare(b.region));

  // Upload to Firestore → locations/SA
  try {
    await setDoc(doc(db, 'locations', 'SA'), { data: locationsArray });
    console.log('✅ Locations uploaded successfully to Firestore!');
    alert('تم رفع بيانات المواقع إلى Firebase بنجاح!');
  } catch (error) {
    console.error('❌ Error uploading locations:', error);
    alert('فشل رفع البيانات: ' + error.message);
  }
};